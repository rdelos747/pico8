pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
ppx,ppy=64,64
pp_ya=0

objs={}


function _init()
	srand(2)
	for i=0,10 do
		local rx=flr(rnd()*128)
		local ry=flr(rnd()*128)
		add(objs,{rx,ry,0})
	end
end

function _draw()
	cls()
	
	for o in all(objs)do
		if(in_view(o))pal(5,12)
		spr(1,o[1]-2,o[2]-2)	
		//pset(o[1],o[2],7)
		pal()
		print(o[3],o[1],o[2],1)
		print(
			((o[3]-pp_ya)+0.1)%1,
			o[1],
			o[2]+6,1)
	end
	
	print(pp_ya,ppx,ppy,7)
	line(
		ppx,ppy,
		ppx+cos(pp_ya)*64,
		ppy+sin(pp_ya)*64,
		9)
	line(
		ppx,ppy,
		ppx+cos(pp_ya-0.1)*64,
		ppy+sin(pp_ya-0.1)*64,
		15)
	line(
		ppx,ppy,
		ppx+cos(pp_ya+0.1)*64,
		ppy+sin(pp_ya+0.1)*64,
		15)
end

function _update()
	local spd=0
	if(btn(⬅️))pp_ya+=0.01
	if(btn(➡️))pp_ya-=0.01
	if(btn(⬆️))spd=1
	if(btn(⬇️))spd=-1
	pp_ya=pp_ya%1
	
	ppx+=cos(pp_ya)*spd
	ppy+=sin(pp_ya)*spd
	
	for o in all(objs)do
		local a=atan2(
			o[1]-ppx,
			o[2]-ppy
		)
		o[3]=a
	end
end

function in_view(o)
	local a=((o[3]-pp_ya)+0.1)%1
	return a<0.2
end

__gfx__
00000000500050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000500050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
